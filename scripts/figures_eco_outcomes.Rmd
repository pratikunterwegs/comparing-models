---
editor_options: 
  chunk_output_type: console
---

# Ecological outcomes

```{r}
library(data.table)

# for plotting
library(ggplot2)
library(scico)
library(patchwork)
```

Load trait data.

```{r}
# list files
trait_data = list.files(
  "inst/data/", pattern = "trait", full.names = TRUE
)

# read files
trait_data = lapply(trait_data, fread)

# get similar columns and add social strategy
trait_data = lapply(trait_data, function(df) {
  
  # assign social strategy and dispersal
  if(!"social_strat" %in% colnames(df)) {
    df[, social_strat := "none"]
  }
  if(!"dispersal" %in% colnames(df)) {
    df[, dispersal := fifelse(type == "evolved", "local", "global")]
  }
  
  df[, c("intake", "energy", "assoc", "moved", "replicate",
         "social_strat", "landscape", "type", "dispersal")]
})

# get as bound df
trait_data = rbindlist(trait_data)

# set levels
trait_data[, type := factor(
  type, levels = c("random", "optimal", "evolved")
)]
```

## Intake

Prepare plot for intake or harvesting.

```{r}
ggplot(trait_data[landscape == "patchy" & dispersal == "global"])+
  geom_boxplot(
    aes(
      type, intake
    )
  )
```

## Distance moved

```{r}
ggplot(trait_data[landscape == "patchy" & dispersal == "global"])+
  geom_boxplot(
    aes(
      type, moved
    )
  )+
  facet_grid(
    cols = vars(dispersal)
  )
```

## Associations

```{r}
ggplot(trait_data[landscape == "patchy" & dispersal == "global"])+
  geom_boxplot(
    aes(
      type, assoc
    )
  )+
  scale_y_sqrt()+
  facet_grid(
    cols = vars(dispersal)
  )
```

## Disease spread

Load SIR model data.

```{r}
data_sir = fread("inst/data/data_sir_thr_12.csv")

# examine only patchy landscapes with global dispersal
data_sir = data_sir[landscape == "patchy" & dispersal == "global"]

# set factor levels
data_sir[, sim_type := factor(sim_type, 
                              levels = c("random", "optimal", "evolved"))]
```

```{r}
ggplot(data_sir[time < 9 & class == "NI"])+
  stat_summary(
    aes(
      time, mean
    )
  )+
  facet_grid(
    cols = vars(sim_type)
  )
```

